(: 
 :	Copyright 2008-2010 Mark Logic Corporation
 :	
 :	Licensed under the Apache License, Version 2.0 (the "License");
 :	you may not use this file except in compliance with the License.
 :	You may obtain a copy of the License at
 :	
 :	    http://www.apache.org/licenses/LICENSE-2.0
 :	
 :	Unless required by applicable law or agreed to in writing, software
 :	distributed under the License is distributed on an "AS IS" BASIS,
 :	WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 :	See the License for the specific language governing permissions and
 :	limitations under the License.
 :	
 :	@author Justin Makeig <jmakeig@marklogic.com>
 :
 :)
xquery version "1.0-ml";
import module namespace s="http://marklogic.com/socrates" at "/lib/socrates.xqy";
declare namespace mvc="http://marklogic.com/mvc";
declare option xdmp:mapping "false";

declare variable $mvc:model as map:map? external;
declare variable $mvc:errors as map:map? external;

<html xmlns="http://www.w3.org/1999/xhtml"> 
	<head>
		<title>Login</title>
		<link href="/assets/browser.css" rel="stylesheet" type="text/css"/>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js" type="text/javascript"/>
	</head>
	<body>
		<h1>Login</h1>
		<form action="{s:get-url-login()}" method="post">
			{
				if(map:get($mvc:errors, "failed-login")) then
				<div class="error">{map:get($mvc:errors, "failed-login")}</div>
				else ()
			}
			<div class="control editor">
		    <div class="label">
		      <label for="user">Name</label>
		    </div>
		    <div class="input">
		    	<div class="front">
						<input name="user" id="user" />
	        </div>
		    </div>
			</div>
			<div class="control editor">
		    <div class="label">
		      <label for="password">Password</label>
		    </div>
		    <div class="input">
		    	<div class="front">
						<input type="password" name="password" id="password" />
	        </div>
		    </div>
			</div>
			<input type="text" name="referer" value="{xdmp:get-request-header("Referer")}"/>
			<div class="actions">
				<button>Login</button>
			</div>
		</form>
		<div>
			<ul>
				<li><a href="/questions">All</a></li>
			</ul>
		</div>
	</body>
</html>